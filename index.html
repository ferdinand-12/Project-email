<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>PingMe - Sign in</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="center-card">
    <div class="logo centered-logo">
      <img src="logo.png" alt="PingMe Logo">
      <div class="logo-text">PingMe</div>
    </div>

    <h1 class="title">Sign in</h1>
    <p class="small" style="text-align:center;color:var(--muted)">to continue to your account</p>

    <div class="form-group">
      <label class="small">Email address</label>
      <input id="email" type="email" />
    </div>
    <div class="form-group">
      <label class="small">Password</label>
      <input id="password" type="password" />
    </div>
    <div style="display:flex;justify-content:center;margin-top:10px">
      <button class="button" id="signin">Sign in</button>
    </div>

    <p style="display:flex;justify-content:space-between;margin-top:14px;font-size:13px;color:var(--muted)">
      <span class="link" id="forgot">Forgot password?</span>
      <a href="signup.html" class="link">Create account</a>
    </p>

    <p id="err" class="error" style="display:none"></p>
  </div>

  <script src="js/app.js"></script>
  <script>
    document.getElementById('signin').addEventListener('click', ()=>{
      const e = document.getElementById('email').value.trim();
      const p = document.getElementById('password').value;
      const errEl = document.getElementById('err');
      errEl.style.display='none';

      if(!e || !p){ errEl.textContent='Semua field wajib diisi.'; errEl.style.display='block'; return; }
      if(!PingMe.isValidEmail(e)){ errEl.textContent='Email tidak valid.'; errEl.style.display='block'; return; }
      const user = PingMe.findUserByEmail(e);
      if(!user || user.password !== p){
        errEl.textContent='Login gagal: email atau kata sandi salah.'; errEl.style.display='block'; return;
      }
      PingMe.loginUser(e);
      window.location.href = 'inbox.html';
    });
  </script>
</body>
</html>
